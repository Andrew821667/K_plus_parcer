# K_plus_parcer

–ü–∞—Ä—Å–µ—Ä –ù–ü–ê (–Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ-–ø—Ä–∞–≤–æ–≤—ã—Ö –∞–∫—Ç–æ–≤) –∏–∑ —Å–∏—Å—Ç–µ–º—ã –ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–ü–ª—é—Å —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è **RAG —Å–∏—Å—Ç–µ–º** –∏ **–æ–±—É—á–µ–Ω–∏—è ML –º–æ–¥–µ–ª–µ–π**.

## üéØ –û—Å–Ω–æ–≤–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

- **Markdown –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π** –¥–ª—è RAG —Å–∏—Å—Ç–µ–º (semantic search, –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ë–î)
- **Chunked –¥–∞–Ω–Ω—ã–µ** –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ (256-512 —Ç–æ–∫–µ–Ω–æ–≤)
- **ML –¥–∞—Ç–∞—Å–µ—Ç—ã** (JSONL) –¥–ª—è fine-tuning —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö LLM
- **–°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ QA-–ø–∞—Ä—ã** –∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è

## üìã –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[CONCEPT.md](CONCEPT.md)** - –ø–æ–ª–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (–≤–µ—Ä—Å–∏—è 2.0)
- **[CONCEPT_UPDATE_SUMMARY.md](CONCEPT_UPDATE_SUMMARY.md)** - –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π v2.0

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (–ø–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ)

### –≠—Ç–∞–ø 1: MVP + Markdown —ç–∫—Å–ø–æ—Ä—Ç ‚≠ê
- –ü–∞—Ä—Å–∏–Ω–≥ PDF –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ù–ü–ê
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–Ω–æ–º–µ—Ä, –¥–∞—Ç–∞, —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞)
- **–≠–∫—Å–ø–æ—Ä—Ç –≤ Markdown** —Å YAML frontmatter (–ü–†–ò–û–†–ò–¢–ï–¢)
- –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON

### –≠—Ç–∞–ø 2: RAG –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ üîç
- Semantic chunking (MarkdownHeaderTextSplitter)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è embeddings (sentence-transformers)
- –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ë–î (ChromaDB, Weaviate)
- –û–±–æ–≥–∞—â—ë–Ω–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–∏—Å–∫–∞

### –≠—Ç–∞–ø 3: ML –¥–∞—Ç–∞—Å–µ—Ç—ã ü§ñ
- JSONL –¥–∞—Ç–∞—Å–µ—Ç—ã –¥–ª—è fine-tuning
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QA-–ø–∞—Ä (OpenAI API)
- –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è (—Å–∏–ª–ª–æ–≥–∏–∑–º—ã)
- Few-shot –ø—Ä–∏–º–µ—Ä—ã

### –≠—Ç–∞–ø 4: NLP –∏ —Å—É—â–Ω–æ—Å—Ç–∏
- Named Entity Recognition (Natasha)
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞—Ç, —Å—É–º–º, —Å—Å—ã–ª–æ–∫ –Ω–∞ –¥—Ä—É–≥–∏–µ –ù–ü–ê
- –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (LexNLP)

### –≠—Ç–∞–ø 5: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- –ü–∞–π–ø–ª–∞–π–Ω: PDF ‚Üí Markdown ‚Üí Chunks ‚Üí VectorDB
- –ü–∞–π–ø–ª–∞–π–Ω: PDF ‚Üí ML Datasets
- –ú–∞—Å—Å–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

**PDF –ø–∞—Ä—Å–∏–Ω–≥:**
- PyMuPDF (fitz) - –±–∞–∑–æ–≤–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ
- pymupdf4llm - Markdown —ç–∫—Å–ø–æ—Ä—Ç
- pdfplumber - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

**NLP –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞:**
- Natasha - —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è, NER
- LexNLP - —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π NLP
- pymorphy2 - –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

**RAG –∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ë–î:**
- LangChain - orchestration
- sentence-transformers - embeddings
- ChromaDB/Weaviate - –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ë–î
- tiktoken - –ø–æ–¥—Å—á—ë—Ç —Ç–æ–∫–µ–Ω–æ–≤

**ML –∏ fine-tuning:**
- HuggingFace datasets
- transformers
- OpenAI API (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö)

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–ø–ª–∞–Ω–∏—Ä—É–µ–º–∞—è)

```
K_plus_parcer/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ extractors/      # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ PDF
‚îÇ   ‚îú‚îÄ‚îÄ parsers/         # –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ exporters/       # –≠–∫—Å–ø–æ—Ä—Ç (Markdown, JSON, XML)
‚îÇ   ‚îú‚îÄ‚îÄ rag/            # ‚≠ê RAG —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
‚îÇ   ‚îú‚îÄ‚îÄ ml/             # ‚≠ê ML –¥–∞—Ç–∞—Å–µ—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ utils/          # –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ input/          # –ò—Å—Ö–æ–¥–Ω—ã–µ PDF
‚îÇ   ‚îî‚îÄ‚îÄ output/
‚îÇ       ‚îú‚îÄ‚îÄ markdown/   # ‚≠ê –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
‚îÇ       ‚îú‚îÄ‚îÄ chunks/     # ‚≠ê Chunked –¥–∞–Ω–Ω—ã–µ
‚îÇ       ‚îú‚îÄ‚îÄ datasets/   # ‚≠ê ML –¥–∞—Ç–∞—Å–µ—Ç—ã
‚îÇ       ‚îî‚îÄ‚îÄ vectordb/   # –í–µ–∫—Ç–æ—Ä–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
‚îî‚îÄ‚îÄ configs/            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```

## üìÑ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–±—É–¥—É—â–µ–µ)

### –ë–∞–∑–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥ —Å Markdown

```bash
python -m k_plus_parcer parse input.pdf \
  --output-dir output/ \
  --format markdown json
```

### RAG –ø–∞–π–ø–ª–∞–π–Ω

```bash
python -m k_plus_parcer rag-pipeline input.pdf \
  --chunk-size 512 \
  --embedding-model paraphrase-multilingual-mpnet-base-v2 \
  --vectordb chromadb
```

### –°–æ–∑–¥–∞–Ω–∏–µ ML –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

```bash
python -m k_plus_parcer ml-dataset input.pdf \
  --generate-qa \
  --generate-reasoning \
  --llm-provider openai
```

## üìä –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### 1. Markdown –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π ‚≠ê (–ü–†–ò–û–†–ò–¢–ï–¢)

```markdown
---
doc_type: –§–ï–î–ï–†–ê–õ–¨–ù–´–ô –ó–ê–ö–û–ù
number: 44-–§–ó
date: 2013-04-05
title: –û –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ...
---

# –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –∑–∞–∫–æ–Ω –æ—Ç 05.04.2013 N 44-–§–ó

## –ì–ª–∞–≤–∞ 1. –û–ë–©–ò–ï –ü–û–õ–û–ñ–ï–ù–ò–Ø

### –°—Ç–∞—Ç—å—è 1. –ü—Ä–µ–¥–º–µ—Ç —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è...
```

### 2. Chunked –¥–∞–Ω–Ω—ã–µ –¥–ª—è RAG üîç

```json
{
  "chunk_id": "44-fz_article-1_chunk-1",
  "text": "–°—Ç–∞—Ç—å—è 1. –ü—Ä–µ–¥–º–µ—Ç —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è...",
  "metadata": {
    "doc_type": "–§–ï–î–ï–†–ê–õ–¨–ù–´–ô –ó–ê–ö–û–ù",
    "chapter": 1,
    "article": "1",
    "token_count": 187
  },
  "embedding": [...]
}
```

### 3. ML –¥–∞—Ç–∞—Å–µ—Ç—ã ü§ñ

```jsonl
{"messages": [{"role": "system", "content": "–¢—ã —ç–∫—Å–ø–µ—Ä—Ç –ø–æ —Ä–æ—Å—Å–∏–π—Å–∫–æ–º—É –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É"}, {"role": "user", "content": "–ß—Ç–æ —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç 44-–§–ó?"}, {"role": "assistant", "content": "..."}]}
{"messages": [...], "metadata": {"type": "legal_reasoning"}}
```

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**LangChain:**
```python
from k_plus_parcer import NPAParser
from langchain.text_splitter import MarkdownHeaderTextSplitter

parser = NPAParser()
result = parser.parse('44-fz.pdf')
markdown_path = result.export_markdown('output/44-fz.md')
```

**–í–µ–∫—Ç–æ—Ä–Ω—ã–µ –ë–î:**
```python
from k_plus_parcer import RAGProcessor

rag = RAGProcessor(chunk_size=512)
chunks = rag.chunk_document(result)
rag.load_to_vectordb(chunks, db_type='chromadb')
```

## üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

–ö–æ–Ω—Ü–µ–ø—Ü–∏—è –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ 2024-2025:
- [I Tested 7 Python PDF Extractors (2025)](https://onlyoneaman.medium.com/i-tested-7-python-pdf-extractors-so-you-dont-have-to-2025-edition-c88013922257)
- [Chunking Strategies for RAG - Weaviate](https://weaviate.io/blog/chunking-strategies-for-rag)
- [Fine-tuning LLMs for Legal QA](https://arxiv.org/html/2501.06521)
- [RusLawOD - Russian Law as Open Data](https://github.com/irlcode/RusLawOD)

## üìà –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** üìù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ (–∑–∞–≤–µ—Ä—à–µ–Ω–∞)
**–í–µ—Ä—Å–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:** 2.0
**–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø:** ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –ù–ü–ê –∏–∑ —Å–∏—Å—Ç–µ–º—ã –ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–ü–ª—é—Å —Å —Ü–µ–ª—å—é —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –¥–ª—è RAG –∏ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è ML –º–æ–¥–µ–ª–µ–π –≤ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏.

---

**–õ–∏—Ü–µ–Ω–∑–∏—è:** TBD
**Python:** 3.8+